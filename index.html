<style>
/* ... (Mantenha todo o CSS anterior aqui) ... */

/* --- NOVO ESTILO: Corações no Rastro do Mouse --- */
.heart-trail {
    position: fixed;
    font-size: 1.5em; /* Tamanho do coração */
    color: var(--cor-principal); /* Cor principal (Rosa) */
    pointer-events: none; /* Garante que os corações não atrapalhem o clique */
    transform: translate(-50%, -50%);
    animation: fadeOut 1s forwards;
    z-index: 5000; /* Deve aparecer acima de tudo, exceto o visualizador de fotos */
    text-shadow: 0 0 5px rgba(255, 105, 180, 0.5);
}

@keyframes fadeOut {
    0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(0.5) translateY(-20px); } /* Desaparece subindo */
}
</style>
</head>
<body>

    <script>
        // --- Elementos Comuns ---
        const mainIntroScreen = document.getElementById('mainIntroScreen');
        const goToEnvelopeBtn = document.getElementById('goToEnvelopeBtn');
        const envelopeScreen = document.getElementById('envelopeScreen');
        const envelope = document.getElementById('envelope');
        const openEnvelopeBtn = document.getElementById('openEnvelopeBtn');
        const openingHeart = document.getElementById('openingHeart');
        const modals = document.querySelectorAll('.modal-overlay');
        const nextButtons = document.querySelectorAll('.modal-next-btn');
        const closeButtons = document.querySelectorAll('.modal-close');
        
        // --- Elementos da Galeria Slideshow ---
        const fullGalleryGrid = document.getElementById('fullGalleryGrid');
        const galleryPhotoCount = document.getElementById('galleryPhotoCount');
        const galleryModal = document.getElementById('galleryModal');
        const photoViewerModal = document.getElementById('photoViewerModal');
        const currentPhotoImg = document.getElementById('currentPhoto');
        const photoCounterSpan = document.getElementById('photoCounter');
        const prevPhotoBtn = document.getElementById('prevPhotoBtn');
        const nextPhotoBtn = document.getElementById('nextPhotoBtn');
        const closePhotoViewerBtn = document.getElementById('closePhotoViewer');
        
        let currentPhotoIndex = 0; // Index da foto atual no slideshow

        // SUAS FOTOS AQUI (Lista completa)
        const allPhotos = [
            'foto_galeria_1.jpg',
            'foto_galeria_2.jpg',
            'foto_galeria_3.jpg',
            'foto_galeria_4.jpg',
            'foto_galeria_5.jpg',
            'foto_galeria_6.jpg',
            'foto_galeria_7.jpg',
            'foto_galeria_8.jpg',
            'foto_galeria_9.jpg',
            'foto_galeria_10.jpg', 
        ];

        // --- FUNÇÕES DE CONTROLE DE TELA/MODAL ---
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            document.body.style.overflow = 'hidden'; 
        }

        function openModal(modalId) {
            closeAllModals(); 
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
            
            const modalContent = document.getElementById(modalId).querySelector('.modal-content');
            if(modalContent) modalContent.scrollTop = 0;

            if (modalId === 'galleryModal') {
                loadGalleryPhotos(); 
            }
        }

        function closeAllModals() {
            modals.forEach(modal => {
                modal.classList.remove('active');
            });
            photoViewerModal.classList.remove('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            showScreen('envelopeScreen'); 
        }
        
        // --- LÓGICA DO SLIDESHOW (Mantida) ---

        function loadGalleryPhotos() {
            fullGalleryGrid.innerHTML = '';
            
            allPhotos.forEach((photoSrc, index) => {
                const img = document.createElement('img');
                img.src = photoSrc;
                img.alt = `Foto ${index + 1}`;
                img.dataset.index = index;
                
                img.addEventListener('click', () => {
                    openPhotoViewer(index);
                });

                fullGalleryGrid.appendChild(img);
            });

            galleryPhotoCount.textContent = `${allPhotos.length} fotos`;
        }
        
        function openPhotoViewer(index) {
            currentPhotoIndex = index;
            updatePhotoViewer();
            galleryModal.classList.remove('active'); 
            photoViewerModal.classList.add('active');
        }
        
        function updatePhotoViewer() {
            const photoSrc = allPhotos[currentPhotoIndex];
            
            currentPhotoImg.style.opacity = 0;
            setTimeout(() => {
                currentPhotoImg.src = photoSrc;
                photoCounterSpan.textContent = `${currentPhotoIndex + 1} de ${allPhotos.length}`;
                currentPhotoImg.style.opacity = 1;
            }, 300);
            
            prevPhotoBtn.disabled = currentPhotoIndex === 0;
            nextPhotoBtn.disabled = currentPhotoIndex === allPhotos.length - 1;
        }

        function navigatePhotos(direction) {
            currentPhotoIndex += direction;
            if (currentPhotoIndex < 0) {
                currentPhotoIndex = 0;
            } else if (currentPhotoIndex >= allPhotos.length) {
                currentPhotoIndex = allPhotos.length - 1;
            }
            updatePhotoViewer();
        }

        // --- Eventos do Slideshow ---
        prevPhotoBtn.addEventListener('click', () => navigatePhotos(-1));
        nextPhotoBtn.addEventListener('click', () => navigatePhotos(1));
        
        closePhotoViewerBtn.addEventListener('click', () => {
            photoViewerModal.classList.remove('active');
            galleryModal.classList.add('active');
        });
        
        document.addEventListener('keydown', (e) => {
            if (photoViewerModal.classList.contains('active')) {
                if (e.key === 'ArrowLeft') {
                    navigatePhotos(-1);
                } else if (e.key === 'ArrowRight') {
                    navigatePhotos(1);
                } else if (e.key === 'Escape') {
                    photoViewerModal.classList.remove('active');
                    galleryModal.classList.add('active');
                }
            }
        });


        // --- EVENTOS DE FLUXO PRINCIPAL (Mantidos) ---
        
        goToEnvelopeBtn.addEventListener('click', () => {
            showScreen('envelopeScreen');
        });

        openEnvelopeBtn.addEventListener('click', () => {
            envelope.style.opacity = 0;
            envelope.style.pointerEvents = 'none';
            openingHeart.style.display = 'block';

            setTimeout(() => {
                openingHeart.style.display = 'none'; 
                openModal('messageModal'); 
                envelope.style.opacity = 1; 
                envelope.style.pointerEvents = 'auto';
            }, 1000); 
        });

        nextButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                const currentModal = e.target.closest('.modal-overlay');
                const nextModalId = button.dataset.nextModal;
                
                closeModal(currentModal.id);
                openModal(nextModalId);
            });
        });

        closeButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                const currentModal = e.target.closest('.modal-overlay');
                closeModal(currentModal.id);
            });
        });


        // --- NOVO CÓDIGO: RASTRO DE CORAÇÕES ---
        document.addEventListener('mousemove', createHeartTrail);
        document.addEventListener('touchstart', createHeartTrail);
        document.addEventListener('touchmove', createHeartTrail);

        let lastHeartTime = 0;

        function createHeartTrail(e) {
            const now = Date.now();
            
            // Limita a frequência para evitar sobrecarga (corações demais)
            if (now - lastHeartTime < 50) { 
                return;
            }
            lastHeartTime = now;

            // Determina a posição X e Y (funciona para mouse e toque)
            const x = e.clientX || (e.touches && e.touches[0].clientX);
            const y = e.clientY || (e.touches && e.touches[0].clientY);

            if (x === undefined || y === undefined) return;

            const heart = document.createElement('i');
            heart.classList.add('fas', 'fa-heart', 'heart-trail');
            
            // Define a posição
            heart.style.left = `${x}px`;
            heart.style.top = `${y}px`;
            
            // Adiciona um pequeno giro aleatório
            const rotation = Math.random() * 40 - 20; // Entre -20 e 20 graus
            heart.style.transform += ` rotate(${rotation}deg)`; 
            
            document.body.appendChild(heart);

            // Remove o coração após a animação (1 segundo)
            setTimeout(() => {
                heart.remove();
            }, 1000);
        }

    </script>

</body>
</html>
